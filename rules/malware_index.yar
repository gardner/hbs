rule Detect_UPX_Packed
{
  meta:
    description = "Detect UPX-packed binaries"
    author = "HBS"
  strings:
    $upx1 = "UPX!"
    $upx2 = ".UPX0"
    $upx3 = ".UPX1"
  condition:
    any of them
}

rule Suspicious_Crypto_Artifacts
{
  meta:
    description = "Common crypto strings that may warrant deeper review"
    author = "HBS"
  strings:
    $s1 = "RC4"
    $s2 = "AES"
    $s3 = "SHA1"
    $s4 = "MD5"
    $s5 = "ChaCha20"
  condition:
    # Not inherently maliciousâ€”just flags for review
    2 of ($s*)
}

rule Suspicious_URL_Patterns
{
  meta:
    description = "Heuristic URL patterns inside binaries"
    author = "HBS"
  strings:
    $http = "http://"
    $https = "https://"
  condition:
    any of ($http,$https)
}
